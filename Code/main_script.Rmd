---
title: "Main"
author: "jessica moczulski"
date: "2023-04-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("readr")
install.packages("lubridate")
library(dplyr)
library(tidyr)
library(readr) 
library(lubridate)
library(ggplot2)
```


air
```{r}
neon_air_CPER <- read_csv("../Data/Processed/CPER/NEON_temp-air-single/CPER_Sep_2017_Air_30min/NEON.D10.CPER.DP1.00002.001.000.030.030.SAAT_30min.2017-09.expanded.20221201T015159Z.csv") %>%
  mutate(siteID = "CPER")

neon_air_RMNP <- read_csv("../Data/Processed/RMNP/RMNP/NEON_temp-air-single/RMNP_Sep_2017_Air/NEON.D10.RMNP.DP1.00002.001.000.030.030.SAAT_30min.2017-09.basic.20221210T032125Z.csv") %>%
  mutate(siteID = "RMNP")
```

```{r}
neon_air_CPER_DAY <- neon_air_CPER %>%
  mutate(day = floor_date(startDateTime, unit = "day"))

summary(neon_air_CPER_DAY)

```
```{r}
neon_air_RMNP_DAY <- neon_air_RMNP %>%
  mutate(day = floor_date(startDateTime, unit = "day"))

summary(neon_air_RMNP_DAY)
```

```{r}
neon_air_total <- bind_rows(neon_air_CPER, neon_air_RMNP)

summary(neon_air_total)

```

```{r}
neon_air_total_DAY <- bind_rows(neon_air_CPER_DAY , neon_air_RMNP_DAY)

summary(neon_air_total_DAY)
```

soil
```{r}
NEON_SOIL_CPER_1 <-read_csv("../Data/Processed/CPER/NEON_heatflux-soil/NEON.D10.CPER.DP1.00040.001.2017-09.expanded.20230127T120753Z.RELEASE-2023/NEON.D10.CPER.DP1.00040.001.001.501.030.SHF_30min.2017-09.expanded.20221201T051650Z.csv")

NEON_SOIL_CPER_2 <-read_csv("../Data/Processed/CPER/NEON_heatflux-soil/NEON.D10.CPER.DP1.00040.001.2017-09.expanded.20230127T120753Z.RELEASE-2023/NEON.D10.CPER.DP1.00040.001.003.501.030.SHF_30min.2017-09.expanded.20221201T051650Z.csv")

NEON_SOIL_CPER_3 <-read_csv("../Data/Processed/CPER/NEON_heatflux-soil/NEON.D10.CPER.DP1.00040.001.2017-09.expanded.20230127T120753Z.RELEASE-2023/NEON.D10.CPER.DP1.00040.001.005.501.030.SHF_30min.2017-09.expanded.20221201T051650Z.csv")

```




```{r}

neon_soil_cper_total <- bind_rows(NEON_SOIL_CPER_1, NEON_SOIL_CPER_2, NEON_SOIL_CPER_3)

summary(neon_soil_cper_total)

```

```{r}

neon_SOIL_CPER_TOTAL_DAY <- neon_soil_cper_total %>%
  mutate(day = floor_date(startDateTime, unit = "day")) %>%
  mutate(siteID = "CPER")

summary(neon_SOIL_CPER_TOTAL_DAY)
```

```{r}
NEON_SOIL_RMNP_1 <-read_csv("../Data/Processed/RMNP/NEON_heatflux-soil/NEON.D10.RMNP.DP1.00040.001.2017-09.basic.20230127T120753Z.RELEASE-2023/NEON.D10.RMNP.DP1.00040.001.001.501.030.SHF_30min.2017-09.basic.20221210T040113Z.csv")

NEON_SOIL_RMNP_2 <-read_csv("../Data/Processed/RMNP/NEON_heatflux-soil/NEON.D10.RMNP.DP1.00040.001.2017-09.basic.20230127T120753Z.RELEASE-2023/NEON.D10.RMNP.DP1.00040.001.003.501.030.SHF_30min.2017-09.basic.20221210T040113Z.csv")

NEON_SOIL_RMNP_3 <-read_csv("../Data/Processed/RMNP/NEON_heatflux-soil/NEON.D10.RMNP.DP1.00040.001.2017-09.basic.20230127T120753Z.RELEASE-2023/NEON.D10.RMNP.DP1.00040.001.005.501.030.SHF_30min.2017-09.basic.20221210T040113Z.csv")
```



```{r}

neon_soil_RMNP_total <- bind_rows(NEON_SOIL_RMNP_1, NEON_SOIL_RMNP_2, NEON_SOIL_RMNP_3)

summary(neon_soil_RMNP_total)

```
```{r}

neon_SOIL_RMNP_TOTAL_DAY <- neon_soil_RMNP_total %>%
  mutate(day = floor_date(startDateTime, unit = "day")) %>%
  mutate(siteID = "RMNP")

summary(neon_SOIL_RMNP_TOTAL_DAY)
```
```{r}

```

```{r}

Neon_VegCPER_1 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_1.csv")  

Neon_VegCPER_2 <-read_csv ("Vegetative_Structure_Code/CPER/Neon_VegCPER_2.csv")

Neon_VegCPER_3 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_3.csv")

Neon_VegCPER_4 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_4.csv")

Neon_VegCPER_5 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_5.csv")

Neon_VegCPER_6 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_6.csv")

Neon_VegCPER_7 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_7.csv")

Neon_VegCPER_8 <-read_csv("Vegetative_Structure_Code/CPER/Neon_VegCPER_8.csv")

```

```{r}
Neon_VegRMNP_1 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_1.csv") 

Neon_VegRMNP_3 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_3.csv")

Neon_VegRMNP_4 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_4.csv")

Neon_VegRMNP_5 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_5.csv")

Neon_VegRMNP_6 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_6.csv")

Neon_VegRMNP_7 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_7.csv")

Neon_VegRMNP_8 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_8.csv")

Neon_VegRMNP_9 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_9.csv")

Neon_VegRMNP_10 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_10.csv")

Neon_VegRMNP_11 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_11.csv")

Neon_VegRMNP_12 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_12.csv")

Neon_VegRMNP_13 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_13.csv")

Neon_VegRMNP_14 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_14.csv")

Neon_VegRMNP_15 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_15.csv")

Neon_VegRMNP_16 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_16.csv")

Neon_VegRMNP_17 <-read_csv("Vegetative_Structure_Code/RMNP/Neon_VegRMNP_17.csv")

```




difference
``` {r}
neon_air_total_DAY %>%
  drop_na(tempSingleMean)%>%
  group_by(siteID, day)%>%
  summarize(mean_temp = mean(tempSingleMean)) -> mean_temp

mean_temp
```
```{r}
neon_soil_total_day <- bind_rows(neon_SOIL_CPER_TOTAL_DAY , neon_SOIL_RMNP_TOTAL_DAY)
```

```{r}
neon_soil_total_day %>%
  drop_na(SHFMean)%>%
  group_by(siteID , day) %>%
  summarize(mean_soil_temp = mean(SHFMean)) -> mean_soil_temp
```

```{r}
neon_difference <- left_join(mean_soil_temp , mean_temp) %>%
  mutate(temp_difference = (mean_temp - mean_soil_temp))

neon_difference
```




```{r}
summary(neon_soil_total_day)
```

<<<<<<< HEAD

Second Figure- Vegetative composition 

``` {r}
neon_veg_CPER <- bind_rows(Neon_VegCPER_1, Neon_VegCPER_2, Neon_VegCPER_3, Neon_VegCPER_4, Neon_VegCPER_5, Neon_VegCPER_6, Neon_VegCPER_7, Neon_VegCPER_8)
 

summary(neon_veg_CPER)

neon_veg_RMNP <- bind_rows(Neon_VegRMNP_1, Neon_VegRMNP_3, Neon_VegRMNP_4, Neon_VegRMNP_5, Neon_VegRMNP_6, Neon_VegRMNP_7, Neon_VegRMNP_8, Neon_VegRMNP_9, Neon_VegRMNP_10, Neon_VegRMNP_11, Neon_VegRMNP_12, Neon_VegRMNP_13, Neon_VegRMNP_14, Neon_VegRMNP_15, Neon_VegRMNP_16, Neon_VegRMNP_17)


summary(neon_veg_RMNP)



```

```{r}
Neon_Veg_CPER2017 <- neon_veg_CPER %>% 
  filter(as_date(date) >= as_date("2017-01-01") & 
         as_date(date) <= as_date("2017-12-31"))

summary(Neon_Veg_CPER2017)

Neon_Veg_RMNP2017 <- neon_veg_RMNP %>% 
  filter(as_date(date) >= as_date("2017-01-01") & 
         as_date(date) <= as_date("2017-12-31"))

summary(Neon_Veg_RMNP2017)


```

```{r}

neon_veg_CPERsummary <- Neon_Veg_CPER2017 %>%
  group_by(plotID, siteID) %>%
  summarize(mean_cover = mean(maxCrownDiameter, na.rm=T)) %>%
  drop_na()

neon_veg_CPERsummary

```

```{r}
neon_veg_RMNPsummary <- Neon_Veg_RMNP2017 %>%
  group_by(plotID, siteID) %>%
  summarize(mean_cover = mean(maxCrownDiameter, na.rm=T)) %>%
  drop_na()

neon_veg_RMNPsummary

```


```{r}
total_veg <- bind_rows(neon_veg_RMNPsummary,neon_veg_CPERsummary)
summary(total_veg)

```


```{r}
total_veg%>%
  group_by(siteID)%>%
  summarize(mean_cover = mean(maxCrownDiameter, na.rm=T)) %>%
  drop_na() %>%
  ggplot(aes(x=siteID, y=mean_cover, fill= siteID))+ 
  geom_col(position="dodge")

```
#Figure 2 shows the mean percent cover found within the sites RMNP and CPER. The mean cover recorded includes the max crown diameter of the vegetation found within both sites. 


=======
```{r}

neon_difference %>%
  group_by(day , siteID) %>%
  ggplot(aes(x = day , y = temp_difference)) +
  geom_point(aes(color = siteID)) +
  geom_line(aes(color = siteID))

```
Figure Caption: The line plot above describes the relationship between the temperature difference of air and soil between two sites during September 2017. The red lines are RMNP. The blue lines CPER.

```{r}

model_Temp_Diff <- aov(temp_difference ~siteID, data = neon_difference)

summary(model_Temp_Diff)

TukeyHSD(model_Temp_Diff)

```
```{r}

```


```{r}

plot(model_Temp_Diff)

```


<<<<<<< HEAD
=======
```{r}

neon_soil_cper_total <- bind_rows(NEON_SOIL_CPER_1, NEON_SOIL_CPER_2, NEON_SOIL_CPER_3) %>%
  mutate(SiteID = "CPER")

summary(neon_soil_cper_total)

neon_SOIL_CPER_TOTAL_DAY <- neon_soil_cper_total %>%
  mutate(day = floor_date(startDateTime, unit = "day")) %>% 
  mutate(SiteID ="CPER")

summary(neon_SOIL_CPER_TOTAL_DAY)

neon_SOIL_CPER_TOTAL_DAY %>% 
  group_by(day) %>% 
  summarize(mean_temp = mean(SHFMean), standard_error = sd(SHFMean)/sqrt(n())) %>% 
  ggplot(aes(x=day, y=mean_temp))+
  geom_col()+
  geom_errorbar(aes(ymin = mean_temp - standard_error, ymax = mean_temp + standard_error), width = .8)


```

```{r}

neon_soil_RMNP_total <- bind_rows(NEON_SOIL_RMNP_1, NEON_SOIL_RMNP_2, NEON_SOIL_RMNP_3) %>% 
  mutate(SiteID = "RMNP")

summary(neon_soil_RMNP_total)

neon_SOIL_RMNP_TOTAL_DAY <- neon_soil_RMNP_total %>%
  mutate(day = floor_date(startDateTime, unit = "day")) %>% 
  mutate(SiteID = "RMNP")

summary(neon_SOIL_RMNP_TOTAL_DAY)

neon_SOIL_RMNP_TOTAL_DAY %>% 
  group_by(day) %>% 
  summarize(mean_temp = mean(SHFMean), standard_error = sd(SHFMean)/sqrt(n())) %>% 
  ggplot(aes(x=day, y=mean_temp))+
  geom_col()+
  geom_errorbar(aes(ymin = mean_temp - standard_error, ymax = mean_temp + standard_error), width = .8)


```

```{r}

neon_soil_total <- bind_rows(neon_SOIL_RMNP_TOTAL_DAY, neon_SOIL_CPER_TOTAL_DAY) %>% 
  mutate(day = floor_date(startDateTime, unit = "day")) %>%
  mutate(siteID = "RMNP", "CPER")

summary(neon_soil_total)

```


